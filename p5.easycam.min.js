"use strict";var Dw=function(t){const e={LIBRARY:"p5.EasyCam",VERSION:"1.0.10",AUTHOR:"p5.EasyCam authors",SOURCE:"https://github.com/jwdunn1/p5.EasyCam",toString:function(){return this.LIBRARY+" v"+this.VERSION+" by "+this.AUTHOR+" ("+this.SOURCE+")"}};class s{constructor(t,s){if(t instanceof p5.RendererGL){void 0===(s=s||{}).distance&&(s.distance=500),void 0===s.center&&(s.center=[0,0,0]),void 0===s.rotation&&(s.rotation=o.identity()),void 0===s.viewport&&(s.viewport=[0,0,t.width,t.height]),this.INFO=e,this.setCanvas(t);var n=this;this.cam=n,this.LOOK=[0,0,1],this.UP=[0,1,0],this.AXIS=new function(){this.YAW=1,this.PITCH=2,this.ROLL=4,this.ALL=this.YAW|this.PITCH|this.ROLL},this.SHIFT_CONSTRAINT=0,this.FIXED_CONSTRAINT=0,this.DRAG_CONSTRAINT=0,this.scale_rotation=.001,this.scale_pan=2e-4,this.scale_zoom=.001,this.scale_zoomwheel=20,this.distance_min_limit=.01,this.distance_min=1,this.distance_max=Number.MAX_VALUE,this.state={distance:s.distance,center:s.center.slice(),rotation:s.rotation.slice(),copy:function(t){return(t=t||{}).distance=this.distance,t.center=this.center.slice(),t.rotation=this.rotation.slice(),t}},this.state_reset=this.state.copy(),this.state_pushed=this.state.copy(),this.viewport=s.viewport.slice(),this.mouse={cam:n,curr:[0,0,0],prev:[0,0,0],dist:[0,0,0],mwheel:0,isPressed:!1,istouchdown:!1,ismousedown:!1,BUTTON:{LMB:1,MMB:2,RMB:4},button:0,mouseDragLeft:n.mouseDragRotate.bind(n),mouseDragCenter:n.mouseDragPan.bind(n),mouseDragRight:n.mouseDragZoom.bind(n),mouseWheelAction:n.mouseWheelZoom.bind(n),touchmoveSingle:n.mouseDragRotate.bind(n),touchmoveMulti:function(){n.mouseDragPan(),n.mouseDragZoom()},insideViewport:function(t,e){var s=n.viewport[0],a=s+n.viewport[2],i=n.viewport[1],o=i+n.viewport[3];return t>s&&t<a&&e>i&&e<o},solveConstraint:function(){var t=this.dist[0],e=this.dist[1];this.shiftKey&&!n.SHIFT_CONSTRAINT&&Math.abs(t-e)>1&&(n.SHIFT_CONSTRAINT=Math.abs(t)>Math.abs(e)?n.AXIS.YAW:n.AXIS.PITCH),n.DRAG_CONSTRAINT=n.AXIS.ALL,n.FIXED_CONSTRAINT&&(n.DRAG_CONSTRAINT=n.FIXED_CONSTRAINT),n.SHIFT_CONSTRAINT&&(n.DRAG_CONSTRAINT=n.SHIFT_CONSTRAINT)},updateInput:function(t,e,s){var a=n.mouse,i=n.P5.pixelDensity();a.prev[0]=a.curr[0],a.prev[1]=a.curr[1],a.prev[2]=a.curr[2],a.curr[0]=t,a.curr[1]=e,a.curr[2]=s,a.dist[0]=-(a.curr[0]-a.prev[0])/i,a.dist[1]=-(a.curr[1]-a.prev[1])/i,a.dist[2]=-(a.curr[2]-a.prev[2])/i},mousedown:function(t){var e=n.mouse;0===t.button&&(e.button|=e.BUTTON.LMB),1===t.button&&(e.button|=e.BUTTON.MMB),2===t.button&&(e.button|=e.BUTTON.RMB),e.insideViewport(t.x,t.y)&&(e.updateInput(t.x,t.y,t.y),e.ismousedown=e.button>0,e.isPressed=e.ismousedown,n.SHIFT_CONSTRAINT=0)},mousedrag:function(){n.P5.pixelDensity();var t=n.mouse;if(t.ismousedown){var e=n.P5.mouseX,s=n.P5.mouseY,a=s;t.updateInput(e,s,a),t.solveConstraint();var i=t.button&t.BUTTON.LMB,o=t.button&t.BUTTON.MMB,r=t.button&t.BUTTON.RMB;i&&t.mouseDragLeft&&t.mouseDragLeft(),o&&t.mouseDragCenter&&t.mouseDragCenter(),r&&t.mouseDragRight&&t.mouseDragRight()}},mouseup:function(t){var e=n.mouse;0===t.button&&(e.button&=~e.BUTTON.LMB),1===t.button&&(e.button&=~e.BUTTON.MMB),2===t.button&&(e.button&=~e.BUTTON.RMB),e.ismousedown=e.button>0,e.isPressed=e.istouchdown||e.ismousedown,n.SHIFT_CONSTRAINT=0},dblclick:function(t){var e=t.x,s=t.y;n.mouse.insideViewport(e,s)&&n.reset()},wheel:function(t){var e=t.x,s=t.y,a=n.mouse;a.insideViewport(e,s)&&(a.mwheel=.01*t.deltaY,a.mouseWheelAction&&a.mouseWheelAction())},evaluateTouches:function(t){var e,s,a,i=t.touches,o=0,r=0,h=0,u=i.length;for(e=0;e<u;e++)o+=i[e].clientX,r+=i[e].clientY;for(o/=u,r/=u,e=0;e<u;e++)s=o-i[e].clientX,a=r-i[e].clientY,h+=Math.sqrt(s*s+a*a);h/=u,n.mouse.updateInput(o,r,-h)},touchstart:function(t){t.preventDefault(),t.stopPropagation();var e=n.mouse;e.evaluateTouches(t),e.istouchdown=e.insideViewport(e.curr[0],e.curr[1]),e.isPressed=n.mouse.istouchdown||n.mouse.ismousedown,e.dbltap(t)},touchmove:function(t){t.preventDefault(),t.stopPropagation();var e=n.mouse;e.istouchdown&&(e.evaluateTouches(t),e.solveConstraint(),1===t.touches.length?e.touchmoveSingle():(e.touchmoveMulti(),e.tapcount=0))},touchend:function(t){t.preventDefault(),t.stopPropagation();var e=n.mouse;e.istouchdown=!1,e.isPressed=e.istouchdown||e.ismousedown,n.SHIFT_CONSTRAINT=0,e.tapcount>=2&&(e.insideViewport(e.curr[0],e.curr[1])&&n.reset(),e.tapcount=0)},tapcount:0,dbltap:function(t){0==n.mouse.tapcount++&&setTimeout(function(){n.mouse.tapcount=0},350)},shiftKey:!1,keydown:function(t){var e=n.mouse;e.shiftKey||(e.shiftKey=16===t.keyCode)},keyup:function(t){var e=n.mouse;e.shiftKey&&(e.shiftKey=16!==t.keyCode,e.shiftKey||(n.SHIFT_CONSTRAINT=0))}},this.attachMouseListeners(),this.auto_update=!0,this.P5.registerMethod("pre",function(){n.auto_update&&n.update()}),this.dampedZoom=new a(function(t){n.zoom(t*n.getZoomMult())}),this.dampedPanX=new a(function(t){n.panX(t*n.getPanMult())}),this.dampedPanY=new a(function(t){n.panY(t*n.getPanMult())}),this.dampedRotX=new a(function(t){n.rotateX(t*n.getRotationMult())}),this.dampedRotY=new a(function(t){n.rotateY(t*n.getRotationMult())}),this.dampedRotZ=new a(function(t){n.rotateZ(t*n.getRotationMult())}),this.timedRot=new i(n.setInterpolatedRotation.bind(n)),this.timedPan=new i(n.setInterpolatedCenter.bind(n)),this.timedzoom=new i(n.setInterpolatedDistance.bind(n))}else console.log("renderer needs to be an instance of p5.RendererGL")}setCanvas(t){t instanceof p5.RendererGL?(this.renderer=t,t._pInst instanceof p5?this.graphics=t:this.graphics=t._pInst,this.P5=this.graphics._pInst):(this.graphics=void 0,this.renderer=void 0)}getCanvas(){return this.renderer}attachListener(t,e,s,a){t&&t!==s.el&&(this.detachListener(s),s.el=t,s.ev=e,s.op=a,s.el.addEventListener(s.ev,s,s.op))}detachListener(t){t.el&&(t.el.removeEventListener(t.ev,t,t.op),t.el=void 0)}attachMouseListeners(t){var e=this.cam,s=e.mouse;if(t=t||e.renderer){var a={passive:!1},i=t.elt;e.attachListener(i,"mousedown",s.mousedown,a),e.attachListener(i,"mouseup",s.mouseup,a),e.attachListener(i,"dblclick",s.dblclick,a),e.attachListener(i,"wheel",s.wheel,a),e.attachListener(i,"touchstart",s.touchstart,a),e.attachListener(i,"touchend",s.touchend,a),e.attachListener(i,"touchmove",s.touchmove,a),e.attachListener(window,"keydown",s.keydown,a),e.attachListener(window,"keyup",s.keyup,a)}}removeMouseListeners(){var t=this.cam,e=t.mouse;t.detachListener(e.mousedown),t.detachListener(e.mouseup),t.detachListener(e.dblclick),t.detachListener(e.wheel),t.detachListener(e.keydown),t.detachListener(e.keyup),t.detachListener(e.touchstart),t.detachListener(e.touchend),t.detachListener(e.touchmove)}dispose(){removeMouseListeners()}getAutoUpdate(){return this.auto_update}setAutoUpdate(t){this.auto_update=t}update(){var t=this.cam;t.mouse.mousedrag();var e=!1;e|=t.dampedZoom.update(),e|=t.dampedPanX.update(),e|=t.dampedPanY.update(),e|=t.dampedRotX.update(),e|=t.dampedRotY.update(),(e|=t.dampedRotZ.update())?(t.timedRot.stop(),t.timedPan.stop(),t.timedzoom.stop()):(t.timedRot.update(),t.timedPan.update(),t.timedzoom.update()),t.apply()}apply(t){var e=this.cam;(t=t||e.renderer)&&(this.camEYE=this.getPosition(this.camEYE),this.camLAT=this.getCenter(this.camLAT),this.camRUP=this.getUpVector(this.camRUP),t._curCamera.camera(this.camEYE[0],this.camEYE[1],this.camEYE[2],this.camLAT[0],this.camLAT[1],this.camLAT[2],this.camRUP[0],this.camRUP[1],this.camRUP[2]))}setViewport(t){this.viewport=t.slice()}getViewport(){return this.viewport}mouseWheelZoom(){var t=this.mouse;this.dampedZoom.addForce(t.mwheel*this.scale_zoomwheel)}mouseDragZoom(){var t=this.mouse;this.dampedZoom.addForce(-t.dist[2])}mouseDragPan(){var t=this.mouse;this.dampedPanX.addForce(this.DRAG_CONSTRAINT&this.AXIS.YAW?t.dist[0]:0),this.dampedPanY.addForce(this.DRAG_CONSTRAINT&this.AXIS.PITCH?t.dist[1]:0)}mouseDragRotate(){var t=this,e=t.mouse,s=e.curr[0],a=e.curr[1],i=e.dist[0],o=e.dist[1],n=2*Math.min(Math.max((s-t.viewport[0])/t.viewport[2],0),1)-1,r=2*Math.min(Math.max((a-t.viewport[1])/t.viewport[3],0),1)-1;t.DRAG_CONSTRAINT&t.AXIS.YAW&&t.dampedRotY.addForce(+i*(1-r*r)),t.DRAG_CONSTRAINT&t.AXIS.PITCH&&t.dampedRotX.addForce(-o*(1-n*n)),t.DRAG_CONSTRAINT&t.AXIS.ROLL&&(t.dampedRotZ.addForce(-i*r),t.dampedRotZ.addForce(+o*n))}getZoomMult(){return this.state.distance*this.scale_zoom}getPanMult(){return this.state.distance*this.scale_pan}getRotationMult(){return Math.pow(Math.log10(1+this.state.distance),.5)*this.scale_rotation}zoom(t){var e=this.cam,s=e.state.distance+t;s<e.distance_min&&(s=e.distance_min,e.dampedZoom.stop()),s>e.distance_max&&(s=e.distance_max,e.dampedZoom.stop()),e.state.distance=s}panX(t){var e=this.cam.state;if(t){var s=o.applyToVec3(e.rotation,[t,0,0]);r.add(e.center,s,e.center)}}panY(t){var e=this.cam.state;if(t){var s=o.applyToVec3(e.rotation,[0,t,0]);r.add(e.center,s,e.center)}}pan(t,e){this.cam.panX(t),this.cam.panY(t)}rotateX(t){this.cam.rotate([1,0,0],t)}rotateY(t){this.cam.rotate([0,1,0],t)}rotateZ(t){this.cam.rotate([0,0,1],t)}rotate(t,e){var s=this.cam.state;if(e){var a=o.create({axis:t,angle:e});o.applyToRotation(s.rotation,a,s.rotation)}}setInterpolatedDistance(t,e,s){this.cam.state.distance=n.mix(t,e,n.smoothstep(s))}setInterpolatedCenter(t,e,s){this.cam.state.center=r.mix(t,e,n.smoothstep(s))}setInterpolatedRotation(t,e,s){this.cam.state.rotation=o.slerp(t,e,s)}setDistanceMin(t){this.distance_min=Math.max(t,this.distance_min_limit),this.zoom(0)}setDistanceMax(t){this.distance_max=t,this.zoom(0)}setDistance(t,e){this.timedzoom.start(this.state.distance,t,e,[this.dampedZoom])}getDistance(){return this.state.distance}setCenter(t,e){this.timedPan.start(this.state.center,t,e,[this.dampedPanX,this.dampedPanY])}getCenter(){return this.state.center}setRotation(t,e){this.timedRot.start(this.state.rotation,t,e,[this.dampedRotX,this.dampedRotY,this.dampedRotZ])}getRotation(){return this.state.rotation}getPosition(t){var e=this.cam,s=e.state;return t=r.assert(t),o.applyToVec3(s.rotation,e.LOOK,t),r.mult(t,s.distance,t),r.add(t,s.center,t),t}getUpVector(t){var e=this.cam,s=e.state;return t=r.assert(t),o.applyToVec3(s.rotation,e.UP,t),t}getState(){return this.state.copy()}setState(t,e){t&&(this.setDistance(t.distance,e),this.setCenter(t.center,e),this.setRotation(t.rotation,e))}pushState(){return this.state_pushed=this.getState()}popState(t){this.setState(this.state_pushed,t)}pushResetState(){return this.state_reset=this.getState()}reset(t){this.setState(this.state_reset,t)}setRotationScale(t){this.scale_rotation=t}setPanScale(t){this.scale_pan=t}setZoomScale(t){this.scale_zoom=t}setWheelScale(t){this.scale_zoomwheel=t}getRotationScale(){return this.scale_rotation}getPanScale(){return this.scale_pan}getZoomScale(){return this.scale_zoom}getWheelScale(){return this.scale_zoomwheel}setDamping(t){this.dampedZoom.damping=t,this.dampedPanX.damping=t,this.dampedPanY.damping=t,this.dampedRotX.damping=t,this.dampedRotY.damping=t,this.dampedRotZ.damping=t}setDefaultInterpolationTime(t){this.timedRot.default_duration=t,this.timedPan.default_duration=t,this.timedzoom.default_duration=t}setRotationConstraint(t,e,s){var a=this.cam;a.FIXED_CONSTRAINT=0,a.FIXED_CONSTRAINT|=t?a.AXIS.YAW:0,a.FIXED_CONSTRAINT|=e?a.AXIS.PITCH:0,a.FIXED_CONSTRAINT|=s?a.AXIS.ROLL:0}beginHUD(t,e,s){var a=this.cam;if(t=t||a.renderer){t.push();var i=t.drawingContext,o=(e=void 0!==e?e:t.width,s=void 0!==s?s:t.height,Number.MAX_VALUE);i.flush(),i.disable(i.DEPTH_TEST),this.pushed_uMVMatrix=t.uMVMatrix.copy(),this.pushed_uPMatrix=t.uPMatrix.copy(),t.resetMatrix(),t.ortho(0,e,-s,0,-o,+o)}}endHUD(t){var e=this.cam;if(t=t||e.renderer){var s=t.drawingContext;s.flush(),t.uMVMatrix.set(this.pushed_uMVMatrix),t.uPMatrix.set(this.pushed_uPMatrix),s.enable(s.DEPTH_TEST),t.pop()}}}class a{constructor(t){this.value=0,this.damping=.85,this.action=t}addForce(t){this.value+=t}update(){var t=this.value*this.value>1e-6;return t?(this.action(this.value),this.value*=this.damping):this.stop(),t}stop(){this.value=0}}class i{constructor(t){this.default_duration=300,this.action=t}start(t,e,s,a){for(var i in a)a[i].stop();this.valA=t,this.valB=e,this.duration=void 0===s?this.default_duration:s,this.timer=(new Date).getTime(),this.active=this.duration>0,this.active||this.interpolate(1)}update(){if(this.active){var t=((new Date).getTime()-this.timer)/this.duration;t>.995?(this.interpolate(1),this.stop()):this.interpolate(t)}}interpolate(t){this.action(this.valA,this.valB,t)}stop(){this.active=!1}}var o={assert:function(t){return void 0===t||t.constructor!==Array?[1,0,0,0]:t},identity:function(){return[1,0,0,0]},applyToVec3:function(t,e,s){var[a,i,o]=e,[n,h,u,c]=t,d=h*a+u*i+c*o;return(s=r.assert(s))[0]=2*(n*(a*n-(u*o-c*i))+d*h)-a,s[1]=2*(n*(i*n-(c*a-h*o))+d*u)-i,s[2]=2*(n*(o*n-(h*i-u*a))+d*c)-o,s},applyToRotation(t,e,s){var[a,i,n,r]=t,[h,u,c,d]=e;return(s=o.assert(s))[0]=h*a-(u*i+c*n+d*r),s[1]=u*a+h*i+(c*r-d*n),s[2]=c*a+h*n+(d*i-u*r),s[3]=d*a+h*r+(u*n-c*i),s},slerp:function(t,e,s,a){var[i,n,r,h]=t,[u,c,d,m]=e,p=i*u+n*c+r*d+h*m;p<0&&(u=-u,c=-c,d=-d,m=-m,p=-p);var l,v,T=Math.acos(p),R=Math.sqrt(1-p*p);return R>.001?(l=Math.sin((1-s)*T)/R,v=Math.sin(s*T)/R):(l=1-s,v=s),(a=o.assert(a))[0]=l*i+v*u,a[1]=l*n+v*c,a[2]=l*r+v*d,a[3]=l*h+v*m,o.create({rotation:a,normalize:!0},a)},create:function(t,e){if(e=o.assert(e),t.axis){var s=t.axis,a=t.angle,i=r.mag(s);if(0==i)return;var n=-.5*a,h=Math.sin(n)/i;return e[0]=Math.cos(n),e[1]=h*s[0],e[2]=h*s[1],e[3]=h*s[2],e}if(t.rotation){if(e[0]=t.rotation[0],e[1]=t.rotation[1],e[2]=t.rotation[2],e[3]=t.rotation[3],t.normalize){var u=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]);e[0]*=u,e[1]*=u,e[2]*=u,e[3]*=u}return e}if(t.angles_xyz){var c=-.5*t.angles_xyz[0],d=-.5*t.angles_xyz[1],m=-.5*t.angles_xyz[2],p=[Math.cos(c),Math.sin(c),0,0],l=[Math.cos(d),0,Math.sin(d),0],v=[Math.cos(m),0,0,Math.sin(m)];return o.applyToRotation(l,v,e),o.applyToRotation(p,e,e),e}}},n={mix:function(t,e,s){return t*(1-s)+e*s},smoothstep:function(t){return t*t*(3-2*t)},smootherstep:function(t){return x*x*x*(x*(6*x-15)+10)}},r={assert:function(t){return void 0===t||t.constructor!==Array?[0,0,0]:t},isScalar:function(t){return void 0!==t&&t.constructor!==Array},add:function(t,e,s){return s=this.assert(s),this.isScalar(e)?(s[0]=t[0]+e,s[1]=t[1]+e,s[2]=t[2]+e):(s[0]=t[0]+e[0],s[1]=t[1]+e[1],s[2]=t[2]+e[2]),s},mult:function(t,e,s){return s=this.assert(s),this.isScalar(e)?(s[0]=t[0]*e,s[1]=t[1]*e,s[2]=t[2]*e):(s[0]=t[0]*e[0],s[1]=t[1]*e[1],s[2]=t[2]*e[2]),s},magSq:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},mag:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},cross:function(t,e,s){return(s=this.assert(s))[0]=t[1]*e[2]-t[2]*e[1],s[1]=t[2]*e[0]-t[0]*e[2],s[2]=t[0]*e[1]-t[1]*e[0],s},angle:function(t,e){var s=this.mag(t)*this.mag(e);if(0===s)return 0;var a=this.dot(t,e),i=.9999*s;if(a<-i||a>i){var o=this.cross(t,e);return a>=0?Math.asin(this.mag(o)/s):Math.PI-Math.asin(this.mag(o)/s)}return Math.acos(a/s)},mix(t,e,s,a){return(a=this.assert(a))[0]=n.mix(t[0],e[0],s),a[1]=n.mix(t[1],e[1],s),a[2]=n.mix(t[2],e[2],s),a}};return s.INFO=e,Object.freeze(e),(t=void 0!==t?t:{}).EasyCam=s,t.DampedAction=a,t.Interpolation=i,t.Rotation=o,t.Vec3=r,t.Scalar=n,t}(Dw);p5&&(p5.prototype.createEasyCam=function(){var t=this._renderer,e=arguments[0];return arguments[0]instanceof p5.RendererGL&&(t=arguments[0],e=arguments[1]),new Dw.EasyCam(t,e)});